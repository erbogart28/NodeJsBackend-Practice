{"changed":true,"filter":false,"title":"passport.js","tooltip":"/config/passport.js","value":"var passport = require('passport');\nvar LocalStrategy = require('passport-local').Strategy;\nvar mongoose = require('mongoose');\nvar User = mongoose.model('User');\n\npassport.use(new LocalStrategy({\n  usernameField: 'user[email]',\n  passwordField: 'user[password]'\n}, function(email, password, done) {\n  User.findOne({email: email}).then(function(user){\n    if(!user || !user.validPassword(password)){\n      return done(null, false, {errors: {'email or password': 'is invalid'}});\n    }\n\n    return done(null, user);\n  }).catch(done);\n}));\n\n","undoManager":{"mark":0,"position":-1,"stack":[[{"start":{"row":18,"column":0},"end":{"row":19,"column":0},"action":"insert","lines":["",""],"id":2}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":18,"column":0},"end":{"row":18,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1496159038463}